<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Productos</title>
  <style>
    .error {
      color: red;
      font-size: 0.9em;
      display: none;
    }
  </style>
</head>
<body>
  <h2>Registrar nuevo producto</h2>
  <form id="productoForm" action="http://localhost/tecweb/practicas/p08/set_producto_v2.php" method="post">
    
    <label>Nombre:</label><br>
    <input type="text" id="nombre" name="nombre"><br>
    <span class="error" id="errorNombre">El nombre es requerido y debe tener 100 caracteres o menos.</span><br>

    <label>Marca:</label><br>
    <select id="marca" name="marca">
      <option value="">Selecciona una marca</option>
      <option value="Samsung">Samsung</option>
      <option value="Apple">Apple</option>
      <option value="LG">LG</option>
      <option value="Sony">Sony</option>
      <option value="Xiaomi">Xiaomi</option>
      <option value="Huawei">Huawei</option>
      <option value="Motorola">Motorola</option>
    </select><br>
    <span class="error" id="errorMarca">Debes seleccionar una marca.</span><br>

    <label>Modelo:</label><br>
    <input type="text" id="modelo" name="modelo"><br>
    <span class="error" id="errorModelo">El modelo es requerido, debe ser alfanumérico y tener 25 caracteres o menos.</span><br>

    <label>Precio:</label><br>
    <input type="number" step="0.01" id="precio" name="precio"><br>
    <span class="error" id="errorPrecio">El precio es requerido y debe ser mayor a 99.99</span><br>

    <label>Detalles:</label><br>
    <input type="text" id="detalles" name="detalles"><br>
    <span class="error" id="errorDetalles">Los detalles deben tener 250 caracteres o menos.</span><br>

    <label>Unidades:</label><br>
    <input type="number" id="unidades" name="unidades"><br>
    <span class="error" id="errorUnidades">Las unidades son requeridas y deben ser mayor o igual a 0.</span><br>

    <label>Imagen:</label><br>
    <input type="text" id="imagen" name="imagen" value="img/default.png"><br><br>

    <input type="submit" value="Guardar Producto">
  </form>

  <script>
    document.getElementById('productoForm').addEventListener('submit', function(e) {
      // Prevenir el envío por defecto
      e.preventDefault();
      
      // Limpiar errores previos
      var errores = document.querySelectorAll('.error');
      errores.forEach(function(error) {
        error.style.display = 'none';
      });
      
      var valido = true;
      
      // Validar NOMBRE: requerido y <= 100 caracteres
      var nombre = document.getElementById('nombre').value.trim();
      if (nombre === '' || nombre.length > 100) {
        document.getElementById('errorNombre').style.display = 'block';
        valido = false;
      }
      
      // Validar MARCA: requerida (debe seleccionarse)
      var marca = document.getElementById('marca').value;
      if (marca === '') {
        document.getElementById('errorMarca').style.display = 'block';
        valido = false;
      }
      
      // Validar MODELO: requerido, alfanumérico y <= 25 caracteres
      var modelo = document.getElementById('modelo').value.trim();
      var alfanumerico = /^[a-zA-Z0-9]+$/;
      if (modelo === '' || !alfanumerico.test(modelo) || modelo.length > 25) {
        document.getElementById('errorModelo').style.display = 'block';
        valido = false;
      }
      
      // Validar PRECIO: requerido y > 99.99
      var precio = parseFloat(document.getElementById('precio').value);
      if (isNaN(precio) || precio <= 99.99) {
        document.getElementById('errorPrecio').style.display = 'block';
        valido = false;
      }
      
      // Validar DETALLES: opcional, pero si existe <= 250 caracteres
      var detalles = document.getElementById('detalles').value.trim();
      if (detalles.length > 250) {
        document.getElementById('errorDetalles').style.display = 'block';
        valido = false;
      }
      
      // Validar UNIDADES: requeridas y >= 0
      var unidades = parseInt(document.getElementById('unidades').value);
      if (isNaN(unidades) || unidades < 0) {
        document.getElementById('errorUnidades').style.display = 'block';
        valido = false;
      }
      
      // Validar IMAGEN: opcional, si está vacía usar imagen por defecto
      var imagen = document.getElementById('imagen').value.trim();
      if (imagen === '') {
        document.getElementById('imagen').value = 'img/default.png';
      }
      
      // Si todo es válido, enviar el formulario
      if (valido) {
        this.submit();
      }
    });
  </script>
</body>
</html>